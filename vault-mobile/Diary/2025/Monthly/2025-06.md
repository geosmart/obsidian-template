---
title: 2025-06
tags: []
created: 2025-06-07T08:59:29
updated: 2025-06-09T10:40:57
---

# 2025-06
ä½¿ç”¨ OKR åˆ¶å®šæœˆåº¦ç›®æ ‡å’Œå…³é”®ç»“æœï¼ŒæŒ‰ç…§ PDCA å¾ªç¯ï¼ˆæ—¥/å‘¨/æœˆæ€»ç»“ï¼‰è½åœ°æ‰§è¡Œ

## æœˆè®¡åˆ’
### ä¼ä¸šçŸ¥è¯†åº“
1. çŸ¥è¯†åº“å…ƒæ•°æ®
2. çŸ¥è¯†åº“ API
3. xxx

### ä¸ªäººçŸ¥è¯†åº“
1. MOC å®è·µ
2. æ—¥è®°å®è·µ
3. æ‰“é€ ä¸ªäººä¸»é¡µï¼šç™½æ¿
4. æœˆæ€»ç»“ï¼šæ•°æ®ç»Ÿè®¡ä¼˜åŒ–ä¸º quickadd èœå•

### æˆ·å¤–ç¤¾äº¤
1. å¥åº·ç®¡ç†ï¼šæ¯å‘¨çˆ¬å±± 1 æ¬¡
2. ç¤¾äº¤å…³ç³»ï¼šå®¶åº­ä¼šè®® 4 æ¬¡

## å‘¨æ€»ç»“

> å½“å‰æœˆæ€»ç»“æ–‡ä»¶ï¼ˆ2025-03.mdï¼‰å¯¹åº”çš„å‘¨æŠ¥ï¼Œæ”¾åœ¨ Diary/2025/Weekly ç›®å½•ï¼Œæ ¼å¼ä¸º 2025-W13.mdï¼Œ13 æ˜¯å‘¨åºå·

```dataviewjs
// è·å–å½“å‰æ–‡ä»¶åä¸­çš„å¹´æœˆä¿¡æ¯
function getYearAndMonth(dv) {
  const currentFileName = dv.current().file.name;
  const match = currentFileName.match(/(\d{4})-(\d{2})/);
  
  if (match) {
    return {
      year: match[1],
      month: parseInt(match[2])
    };
  } else {
    const now = new Date();
    return {
      year: now.getFullYear().toString(),
      month: now.getMonth() + 1
    };
  }
}

// ç­›é€‰æŒ‡å®šæœˆä»½çš„å‘¨æ€»ç»“æ–‡ä»¶
function getMonthlyWeeklies(dv, year, month) {
  // è·å–æ‰€æœ‰å‘¨æ€»ç»“æ–‡ä»¶
  const weeklyFiles = dv.pages(`"Diary/${year}/Weekly"`)
    .where(p => p.file.name.startsWith(`${year}-W`))
    .array();
  
  const result = [];
  
  for (const file of weeklyFiles) {
    // ä»æ–‡ä»¶åä¸­æå–å‘¨æ•°
    const weekMatch = file.file.name.match(/W(\d+)/);
    if (!weekMatch) continue;
    
    const weekNum = parseInt(weekMatch[1]);
    
    // è®¡ç®—è¯¥å‘¨çš„æ—¥æœŸ
    const firstDayOfYear = new Date(parseInt(year), 0, 1);
    const dayOfWeek = firstDayOfYear.getDay();
    const daysToFirstMonday = dayOfWeek === 0 ? 1 : (8 - dayOfWeek + 1);
    
    const firstMonday = new Date(parseInt(year), 0, daysToFirstMonday);
    const weekStartDate = new Date(firstMonday);
    weekStartDate.setDate(firstMonday.getDate() + (weekNum - 1) * 7);
    
    // æ£€æŸ¥è¿™ä¸€å‘¨æ˜¯å¦å±äºå½“å‰æœˆä»½
    if (weekStartDate.getMonth() + 1 === month) {
      // è®¡ç®—å‘¨çš„ç»“æŸæ—¥æœŸå¹¶æ ¼å¼åŒ–
      const weekEndDate = new Date(weekStartDate);
      weekEndDate.setDate(weekStartDate.getDate() + 6);
      const dateRange = `${weekStartDate.getMonth() + 1}/${weekStartDate.getDate()} - ${weekEndDate.getMonth() + 1}/${weekEndDate.getDate()}`;
      
      result.push([file.file.link, dateRange]);
    }
  }
  
  return result;
}

// ä¸»æ‰§è¡Œä»£ç 
const { year, month } = getYearAndMonth(dv);
const monthlyWeeklies = getMonthlyWeeklies(dv, year, month);

// æ˜¾ç¤ºç»“æœ
if (monthlyWeeklies.length > 0) {
  dv.table(["æ–‡ä»¶å", "æ—¥æœŸèŒƒå›´"], monthlyWeeklies);
} else {
  dv.paragraph(`æ²¡æœ‰æ‰¾åˆ° ${year}å¹´${month}æœˆ çš„å‘¨æ€»ç»“æ–‡ä»¶`);
}
```

## æ•°æ®ç»Ÿè®¡

```dataviewjs
// âœ… é…ç½®åŒº
const config = {
  gddSectionTitle: "### GDD ç»Ÿè®¡",
  buttonText: "Memos-GDDç»Ÿè®¡",
  chartTitle: "GDD æ ‡ç­¾ç»Ÿè®¡é¥¼å›¾",
  tagPatterns: {
    good: /#### ğŸ‘ Good Â· (\d+)æ¡/,
    difficult: /#### ğŸ’ª Difficult Â· (\d+)æ¡/,
    different: /#### ğŸŒŸ Different Â· (\d+)æ¡/
  }
};

// âœ… æŒ‰é’®å’Œæç¤º
function createGDDStatisticsButton(dv) {
  const buttonContainer = dv.el("div", "", { cls: "gdd-stats-button-container" });
  const button = buttonContainer.createEl("button", {
    text: config.buttonText,
    cls: "gdd-stats-button"
  });
  buttonContainer.style.marginBottom = "20px";

  button.addEventListener("click", async () => {
    await generateAndInsertGDDStatistics(dv);
  });

  const title = `
è¯»å– Diary/[å¹´ä»½]/Weekly å†…å¤šä¸ªå‘¨æ€»ç»“æ–‡ä»¶ï¼Œ
è§£æå‡ºæ ‡ç­¾ #good, #difficult, #different çš„æ¬¡æ•°ï¼Œå¹¶åˆ†ç»„æ±‡æ€»ï¼›
ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œç”Ÿæˆ chartsview æ•°æ®ï¼Œæ’å…¥åˆ°å½“å‰æ–‡ä»¶çš„ ${config.gddSectionTitle} ç« èŠ‚å†…
`;
  dv.el("div", title, {
    cls: "gdd-placeholder",
    attr: { style: "color: #666; margin-bottom: 1em;" }
  });
}

// âœ… è·å–å½“å‰æ–‡ä»¶ä¸­æ¨æ–­çš„å¹´ä»½ä¸æœˆä»½
function getYearAndMonth(dv) {
  const currentFileName = dv.current().file.name;
  const match = currentFileName.match(/(\d{4})-(\d{2})/);
  if (match) {
    return { year: match[1], month: match[2] };
  } else {
    const now = new Date();
    return {
      year: now.getFullYear().toString(),
      month: (now.getMonth() + 1).toString().padStart(2, '0')
    };
  }
}

// âœ… æŸ¥æ‰¾ç¬¦åˆæ¡ä»¶çš„ Weekly æ–‡ä»¶
async function getWeeklyFilesForMonth(dv, year, month) {
  const weeklyFolder = `Diary/${year}/Weekly`;
  const weeklyFiles = [];
  const allWeeklyFiles = dv.pages(`"${weeklyFolder}"`);

  for (const file of allWeeklyFiles) {
    const weekMatch = file.file.name.match(/(\d{4})-W(\d{1,2})/);
    if (weekMatch) {
      const fileYear = weekMatch[1];
      const weekNum = parseInt(weekMatch[2]);
      const janFirst = new Date(fileYear, 0, 1);
      const weekDate = new Date(janFirst.getTime());
      weekDate.setDate(janFirst.getDate() + (weekNum - 1) * 7);
      const weekMonth = (weekDate.getMonth() + 1).toString().padStart(2, '0');
      if (fileYear === year && weekMonth === month) {
        weeklyFiles.push(file);
      }
    }
  }

  return weeklyFiles;
}

// âœ… ç»Ÿè®¡æ ‡ç­¾å‡ºç°æ¬¡æ•°
async function extractGDDCounts(dv, files) {
  let goodCount = 0, difficultCount = 0, differentCount = 0;
  for (const file of files) {
    const content = await dv.io.load(file.file.path);
    const goodMatch = content.match(config.tagPatterns.good);
    const difficultMatch = content.match(config.tagPatterns.difficult);
    const differentMatch = content.match(config.tagPatterns.different);
    if (goodMatch) goodCount += parseInt(goodMatch[1]);
    if (difficultMatch) difficultCount += parseInt(difficultMatch[1]);
    if (differentMatch) differentCount += parseInt(differentMatch[1]);
  }
  return { goodCount, difficultCount, differentCount };
}

// âœ… æ„é€  chartsview å—
function generateChartsViewData(goodCount, difficultCount, differentCount) {
  return `\`\`\`chartsview
type: Pie
data:
  - type: "Good"
    value: ${goodCount}
  - type: "Difficult"
    value: ${difficultCount}
  - type: "Different"
    value: ${differentCount}
options:
  angleField: "value"
  colorField: "type"
  radius: 0.5
  label:
    type: "spider"
    content: "{value}æ¡\\n{percentage}\\n{name}"
  legend:
    layout: "horizontal"
    position: "bottom"
\`\`\``;
}

// âœ… æ›´æ–°å½“å‰æ–‡ä»¶çš„å†…å®¹
async function updateFileContent(app, fileContent, chartsViewData) {
  const currentFile = app.workspace.getActiveFile();
  if (!currentFile) {
    console.error("æ— æ³•è·å–å½“å‰æ–‡ä»¶");
    return false;
  }

  const gddSectionRegex = /(### GDD ç»Ÿè®¡\s*\n)([\s\S]*?)(?=\n### |\n## |\n# |$)/;
  const match = fileContent.match(gddSectionRegex);
  if (!match) {
    new Notice("é”™è¯¯: æœªæ‰¾åˆ° ### GDDç»Ÿè®¡ ç« èŠ‚ï¼Œè¯·å…ˆåˆ›å»ºæ­¤ç« èŠ‚");
    return false;
  }

  const sectionHeader = match[1];
  const sectionContent = match[2];
  const chartsViewRegex = /```chartsview[\s\S]*?```/;
  const hasChartsView = chartsViewRegex.test(sectionContent);

  let newContent;
  if (hasChartsView) {
    const updatedSectionContent = sectionContent.replace(chartsViewRegex, chartsViewData);
    newContent = fileContent.replace(gddSectionRegex, sectionHeader + updatedSectionContent);
  } else {
    newContent = fileContent.replace(gddSectionRegex, sectionHeader + chartsViewData + "\n\n" + sectionContent);
  }

  await app.vault.modify(currentFile, newContent);
  return true;
}

// âœ… ä¸»å‡½æ•°ï¼šç”Ÿæˆ & å†™å…¥ GDD ç»Ÿè®¡
async function generateAndInsertGDDStatistics(dv) {
  try {
    const { year, month } = getYearAndMonth(dv);
    console.log(`åˆ†ææœˆä»½ï¼š${year}-${month}`);

    const weeklyFiles = await getWeeklyFilesForMonth(dv, year, month);
    console.log(`æ‰¾åˆ° ${weeklyFiles.length} ä¸ªå‘¨æ€»ç»“æ–‡ä»¶`);

    if (weeklyFiles.length === 0) {
      new Notice(`æ²¡æœ‰æ‰¾åˆ° ${year}-${month} æœˆä»½çš„å‘¨æ€»ç»“æ–‡ä»¶`);
      return;
    }

    const { goodCount, difficultCount, differentCount } = await extractGDDCounts(dv, weeklyFiles);
    const chartsViewData = generateChartsViewData(goodCount, difficultCount, differentCount);
    const currentFile = app.workspace.getActiveFile();
    const fileContent = await app.vault.read(currentFile);
    const success = await updateFileContent(app, fileContent, chartsViewData);

    if (success) {
      new Notice(`GDD ç»Ÿè®¡å·²æ›´æ–° âœ…\nğŸ‘ Good: ${goodCount} æ¡\nğŸ’ª Difficult: ${difficultCount} æ¡\nğŸŒŸ Different: ${differentCount} æ¡`);
    }
  } catch (error) {
    console.error("GDD ç»Ÿè®¡é”™è¯¯:", error);
    new Notice(`GDD ç»Ÿè®¡é”™è¯¯: ${error.message}`);
  }
}

// âœ… å¯åŠ¨æŒ‰é’®
createGDDStatisticsButton(dv);
```

```dataviewjs
// âœ… é…ç½®åŒº
const config = {
  memoSectionTitle: "### æ ‡ç­¾ç»Ÿè®¡",
  buttonText: "Memos-æ ‡ç­¾ç»Ÿè®¡",
  memoSectionPattern: /## Memos\s*([\s\S]*?)(?=\n## |\n# |$)/,
  tagPattern: /#([a-zA-Z0-9\u4e00-\u9fa5_-]+)/g,
};

// âœ… æŒ‰é’®å’Œæç¤º
function createTagStatisticsButton(dv) {
  const buttonContainer = dv.el("div", "", { cls: "tag-stats-button-container" });
  const button = buttonContainer.createEl("button", {
    text: config.buttonText,
    cls: "tag-stats-button"
  });
  buttonContainer.style.marginBottom = "20px";

  button.addEventListener("click", async () => {
    await generateAndInsertTagStatistics(dv);
  });

  const title = `
è¯»å– Diary/[å¹´ä»½]/Weekly å†…å¤šä¸ªå‘¨æ€»ç»“æ–‡ä»¶ï¼Œ
è§£æå‡º ## Memos ç« èŠ‚å†…æ ‡ç­¾ï¼Œå¹¶åˆ†ç»„æ±‡æ€»ï¼›
ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œç”Ÿæˆ chartsview çš„æŸ±çŠ¶å›¾ æ•°æ®ï¼Œæ’å…¥åˆ°å½“å‰æ–‡ä»¶çš„ ${config.memoSectionTitle} ç« èŠ‚å†…
`;
  dv.el("div", title, {
    cls: "tag-placeholder",
    attr: { style: "color: #666; margin-bottom: 1em;" }
  });
}

// âœ… è·å–å½“å‰æ–‡ä»¶ä¸­æ¨æ–­çš„å¹´ä»½ä¸æœˆä»½
function getYearAndMonth(dv) {
  const currentFileName = dv.current().file.name;
  const match = currentFileName.match(/(\d{4})-(\d{2})/);
  if (match) {
    return { year: match[1], month: match[2] };
  } else {
    const now = new Date();
    return {
      year: now.getFullYear().toString(),
      month: (now.getMonth() + 1).toString().padStart(2, '0')
    };
  }
}

// âœ… æŸ¥æ‰¾ç¬¦åˆæ¡ä»¶çš„ Weekly æ–‡ä»¶
async function getWeeklyFilesForMonth(dv, year, month) {
  const weeklyFolder = `Diary/${year}/Weekly`;
  const weeklyFiles = [];
  const allWeeklyFiles = dv.pages(`"${weeklyFolder}"`);

  for (const file of allWeeklyFiles) {
    const weekMatch = file.file.name.match(/(\d{4})-W(\d{1,2})/);
    if (weekMatch) {
      const fileYear = weekMatch[1];
      const weekNum = parseInt(weekMatch[2]);
      const janFirst = new Date(fileYear, 0, 1);
      const weekDate = new Date(janFirst.getTime());
      weekDate.setDate(janFirst.getDate() + (weekNum - 1) * 7);
      const weekMonth = (weekDate.getMonth() + 1).toString().padStart(2, '0');
      if (fileYear === year && weekMonth === month) {
        weeklyFiles.push(file);
      }
    }
  }

  return weeklyFiles;
}

// âœ… ä»æ–‡ä»¶å†…å®¹ä¸­æå– Memos ç« èŠ‚
function extractMemoSection(content) {
  const match = content.match(config.memoSectionPattern);
  return match ? match[1] : "";
}

// âœ… ä» Memos ç« èŠ‚ä¸­æå–å¹¶ç»Ÿè®¡æ ‡ç­¾
function extractTagsFromMemos(memoSection) {
  const tags = {};
  let match;
  while ((match = config.tagPattern.exec(memoSection)) !== null) {
    const tag = match[1];
    tags[tag] = (tags[tag] || 0) + 1;
  }
  return tags;
}

// âœ… ç»Ÿè®¡æ‰€æœ‰æ–‡ä»¶ä¸­çš„æ ‡ç­¾
async function collectTagStatistics(dv, files) {
  const allTags = {};
  
  for (const file of files) {
    const content = await dv.io.load(file.file.path);
    const memoSection = extractMemoSection(content);
    
    if (memoSection) {
      const fileTags = extractTagsFromMemos(memoSection);
      for (const tag in fileTags) {
        allTags[tag] = (allTags[tag] || 0) + fileTags[tag];
      }
    }
  }
  
  // æŒ‰æ ‡ç­¾å‡ºç°æ¬¡æ•°æ’åº
  const sortedTags = Object.entries(allTags)
    .sort((a, b) => b[1] - a[1])
    .reduce((obj, [key, value]) => {
      obj[key] = value;
      return obj;
    }, {});
  
  return sortedTags;
}

// âœ… æ„é€  chartsview å— (æŸ±çŠ¶å›¾)
function generateChartsViewData(tagStats) {
  let dataLines = [];
  
  // å–å‰10ä¸ªæ ‡ç­¾ï¼ˆå¦‚æœè¶…è¿‡10ä¸ªçš„è¯ï¼‰
  const topTags = Object.entries(tagStats).slice(0, 10);
  
  for (const [tag, count] of topTags) {
    dataLines.push(`  - tag: "#${tag}"\n    count: ${count}`);
  }
  
  return `\`\`\`chartsview
type: Bar
data:
${dataLines.join("\n")}
options:
  xField: "count"
  yField: "tag"
  seriesField: "tag"
  label: 
    position: "right"
\`\`\``;
}

// âœ… æ›´æ–°å½“å‰æ–‡ä»¶çš„å†…å®¹
async function updateFileContent(app, fileContent, chartsViewData) {
  const currentFile = app.workspace.getActiveFile();
  if (!currentFile) {
    console.error("æ— æ³•è·å–å½“å‰æ–‡ä»¶");
    return false;
  }

  const sectionRegex = new RegExp(`(${config.memoSectionTitle}\\s*\\n)([\\s\\S]*?)(?=\\n### |\\n## |\\n# |$)`);
  const match = fileContent.match(sectionRegex);
  
  let newContent;
  if (match) {
    // å¦‚æœç« èŠ‚å·²å­˜åœ¨ï¼Œæ›´æ–°æˆ–æ·»åŠ å›¾è¡¨
    const sectionHeader = match[1];
    const sectionContent = match[2];
    const chartsViewRegex = /```chartsview[\s\S]*?```/;
    const hasChartsView = chartsViewRegex.test(sectionContent);

    if (hasChartsView) {
      // æ›¿æ¢ç°æœ‰å›¾è¡¨
      const updatedSectionContent = sectionContent.replace(chartsViewRegex, chartsViewData);
      newContent = fileContent.replace(sectionRegex, sectionHeader + updatedSectionContent);
    } else {
      // åœ¨ç« èŠ‚å¼€å¤´æ·»åŠ å›¾è¡¨
      newContent = fileContent.replace(sectionRegex, sectionHeader + chartsViewData + "\n\n" + sectionContent);
    }
  } else {
    // å¦‚æœç« èŠ‚ä¸å­˜åœ¨ï¼Œåˆ›å»ºç« èŠ‚å¹¶æ·»åŠ å›¾è¡¨
    if (fileContent.endsWith("\n")) {
      newContent = fileContent + config.memoSectionTitle + "\n" + chartsViewData + "\n\n";
    } else {
      newContent = fileContent + "\n\n" + config.memoSectionTitle + "\n" + chartsViewData + "\n\n";
    }
  }

  await app.vault.modify(currentFile, newContent);
  return true;
}

// âœ… ä¸»å‡½æ•°ï¼šç”Ÿæˆ & å†™å…¥æ ‡ç­¾ç»Ÿè®¡
async function generateAndInsertTagStatistics(dv) {
  try {
    const { year, month } = getYearAndMonth(dv);
    console.log(`åˆ†ææœˆä»½ï¼š${year}-${month}`);

    const weeklyFiles = await getWeeklyFilesForMonth(dv, year, month);
    console.log(`æ‰¾åˆ° ${weeklyFiles.length} ä¸ªå‘¨æ€»ç»“æ–‡ä»¶`);

    if (weeklyFiles.length === 0) {
      new Notice(`æ²¡æœ‰æ‰¾åˆ° ${year}-${month} æœˆä»½çš„å‘¨æ€»ç»“æ–‡ä»¶`);
      return;
    }

    const tagStats = await collectTagStatistics(dv, weeklyFiles);
    const tagCount = Object.keys(tagStats).length;
    
    if (tagCount === 0) {
      new Notice("æœªåœ¨ Memos ç« èŠ‚ä¸­æ‰¾åˆ°ä»»ä½•æ ‡ç­¾");
      return;
    }
    
    const chartsViewData = generateChartsViewData(tagStats);
    const currentFile = app.workspace.getActiveFile();
    const fileContent = await app.vault.read(currentFile);
    const success = await updateFileContent(app, fileContent, chartsViewData);

    if (success) {
      const topTags = Object.entries(tagStats).slice(0, 3);
      const topTagsMessage = topTags.map(([tag, count]) => `#${tag}: ${count}æ¬¡`).join("\n");
      new Notice(`æ ‡ç­¾ç»Ÿè®¡å·²æ›´æ–° âœ…\nå…± ${tagCount} ä¸ªæ ‡ç­¾\n\nå‰ä¸‰åæ ‡ç­¾:\n${topTagsMessage}`);
    }
  } catch (error) {
    console.error("æ ‡ç­¾ç»Ÿè®¡é”™è¯¯:", error);
    new Notice(`æ ‡ç­¾ç»Ÿè®¡é”™è¯¯: ${error.message}`);
  }
}

// âœ… å¯åŠ¨æŒ‰é’®
createTagStatisticsButton(dv);
```

### GDD ç»Ÿè®¡

> ç‚¹å‡»æŒ‰é’® `Memos-GDDç»Ÿè®¡` ç”Ÿæˆ

### æ ‡ç­¾ç»Ÿè®¡

> ç‚¹å‡»æŒ‰é’® `Memos-æ ‡ç­¾ç»Ÿè®¡` ç”Ÿæˆ

## è¡ŒåŠ¨å¤ç›˜

> check: ä½¿ç”¨ obsidian çš„æ•°æ®è§†å›¾ï¼ŒæŒ‰å‘¨æ±‡æ€»ç›®æ ‡æ‰§è¡Œçš„å…³é”®ç»“æœ

```dataviewjs
// é…ç½®åŒº
const config = {
  srcSectionTitle: "å…³é”®æˆæœï¼ˆKRï¼‰",
  sectionDepth: 4, // #### å…³é”®æˆæœï¼ˆKRï¼‰çš„çº§åˆ«æ˜¯4
};

// è·å–å½“å‰æ–‡ä»¶ä¸­æ¨æ–­çš„å¹´ä»½ä¸æœˆä»½
function getYearAndMonth() {
  const currentFileName = dv.current().file.name;
  const match = currentFileName.match(/(\d{4})-(\d{2})/);
  if (match) {
    return { year: match[1], month: match[2] };
  } else {
    const now = new Date();
    return {
      year: now.getFullYear().toString(),
      month: (now.getMonth() + 1).toString().padStart(2, "0")
    };
  }
}

// æ ¹æ®æ—¥æœŸè®¡ç®—ISOæ ‡å‡†çš„å‘¨æ•°
function getISOWeekNumber(date) {
  const startOfYear = new Date(date.getFullYear(), 0, 1);
  const daysOffset = date.getDay() - startOfYear.getDay();
  const dayOfYear = Math.floor((date - startOfYear) / (24 * 60 * 60 * 1000));
  const adjustedDayOfYear = dayOfYear + ((daysOffset >= 0 ? daysOffset : daysOffset + 7) % 7);
  return Math.ceil(adjustedDayOfYear / 7);
}

// æŸ¥æ‰¾ç¬¦åˆæ¡ä»¶çš„ Weekly æ–‡ä»¶
function getWeeklyFilesForMonth(year, month) {
  const weeklyFolder = `Diary/${year}/Weekly`;
  const startDate = new Date(year, month - 1, 1);
  const endDate = new Date(year, month, 0); // è¿™ä¸ªæœˆçš„æœ€åä¸€å¤©
  const startWeek = getISOWeekNumber(startDate);
  const endWeek = getISOWeekNumber(endDate);
  const weeklyFiles = [];

  for (let weekNum = startWeek; weekNum <= endWeek; weekNum++) {
    const fileName = `${year}-W${String(weekNum).padStart(2, '0')}`;
    const file = dv.page(`${weeklyFolder}/${fileName}`);
    
    if (file) {
      weeklyFiles.push({
        file: file,
        weekNum: weekNum
      });
    }
  }

  // æŒ‰å‘¨å·æ’åº
  weeklyFiles.sort((a, b) => a.weekNum - b.weekNum);
  return weeklyFiles;
}

// æå–å…³é”®æˆæœéƒ¨åˆ†
async function extractKeyResults(file) {
  const content = await dv.io.load(file.file.path);
  const lines = content.split("\n");
  
  let inKRSection = false;
  let krContent = [];
  
  for (let i = 0; i < lines.length; i++) {
    const line = lines[i];
    
    // æ£€æŸ¥æ˜¯å¦ä¸ºå…³é”®æˆæœç« èŠ‚æ ‡é¢˜
    if (line.trim().startsWith("#".repeat(config.sectionDepth)) && line.includes(config.srcSectionTitle)) {
      inKRSection = true;
      continue;
    }
    
    // å¦‚æœä¸åœ¨å…³é”®æˆæœç« èŠ‚ï¼Œç»§ç»­ä¸‹ä¸€è¡Œ
    if (!inKRSection) continue;
    
    // æ£€æŸ¥æ˜¯å¦é‡åˆ°ä¸‹ä¸€ä¸ªåŒçº§æˆ–æ›´é«˜çº§çš„æ ‡é¢˜ï¼Œå¦‚æœæ˜¯åˆ™é€€å‡ºå…³é”®æˆæœç« èŠ‚
    if (line.trim().startsWith("#")) {
      const headingLevel = line.trim().indexOf(" ");
      if (headingLevel <= config.sectionDepth) {
        break;
      }
    }
    
    // æ·»åŠ åˆ°å…³é”®æˆæœå†…å®¹
    krContent.push(line);
  }
  
  return krContent.join("\n");
}

// ä¸»å‡½æ•°
async function main() {
  // è·å–å¹´æœˆ
  const { year, month } = getYearAndMonth(dv);
  console.log(`${year}å¹´${month}æœˆ`);
  // è·å–ç›¸å…³çš„å‘¨æ€»ç»“æ–‡ä»¶
  const weeklyFiles = getWeeklyFilesForMonth(year, month);
  console.log(`${weeklyFiles.length}ä¸ªæ–‡ä»¶`); 
  // å¦‚æœæ²¡æœ‰æ‰¾åˆ°æ–‡ä»¶ï¼Œæ˜¾ç¤ºæç¤ºä¿¡æ¯
  if (weeklyFiles.length === 0) {
    dv.paragraph(`âš ï¸ æœªæ‰¾åˆ°${year}å¹´${month}æœˆçš„å‘¨æ€»ç»“æ–‡ä»¶`);
    return;
  }
  
  // æ˜¾ç¤ºæ¯ä¸ªå‘¨æ€»ç»“çš„å…³é”®æˆæœ
  for (const weekFile of weeklyFiles) {
    const weekNum = weekFile.weekNum;
    const content = await extractKeyResults(weekFile.file);
    
    if (content.trim()) {
      dv.header(3, `ç¬¬${weekNum}å‘¨ KR`);
      dv.paragraph(content);
    }
  }
  
} 
// æ‰§è¡Œä¸»å‡½æ•°
main();
```

## ç›®æ ‡å¤ç›˜

> æ ¹æ®è¡ŒåŠ¨æƒ…å†µï¼Œç»“åˆæœˆåº¦è®¡åˆ’ï¼Œè¡ŒåŠ¨å¤ç›˜å†…çš„ KR å®Œæˆæƒ…å†µï¼Œæ‰‹åŠ¨æ€»ç»“ç›®æ ‡å®Œæˆæƒ…å†µ

### å·¥ä½œæˆæœ

### è¾“å…¥ï¼šé˜…è¯»

### è¾“å‡ºï¼šå…¬ä¼—å·

## ç­–ç•¥å¤ç›˜

> å¯¹ç›®æ ‡å®Œæˆæƒ…å†µï¼ŒæŒ‰**GDD**å¤ç›˜åšçš„å¥½çš„å’Œä¸å¥½çš„ï¼Œå¯ä»¥åšå“ªäº›æ”¹è¿›è°ƒæ•´ï¼Œä¸ºä¸‹ä¸ªé˜…è¯»æä¾›å‚è€ƒ
